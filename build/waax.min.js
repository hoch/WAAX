/*! waax v0.1.3 built 2014-02-25 */
window.WX={},function(a){"use strict";function b(b,c,d){function e(b,c){var d=b.shift(),g=d[0],j=d[1],k=new XMLHttpRequest;k.open("GET",j,!0),k.responseType="arraybuffer",k.onprogress=function(a){i(a,g,c)},k.onload=function(){try{var d=a.context.createBuffer(k.response,!1);if(c++,f(g,d),0===b.length)return void h("done");e(b,c)}catch(i){a.log.error("XHR failed ("+i.message+"): "+j)}},k.send()}function f(b,c){if(1===c.numberOfChannels){var d=a.context.createBuffer(2,c.length,a.sampleRate),e=c.getChannelData(0);d.getChannelData(0).set(new Float32Array(e)),d.getChannelData(1).set(new Float32Array(e)),g[b]=d}else g[b]=c}for(var g={},h=function(){a.log.info("loading completed."),c&&c()},i=d||function(b,c,e){var f=~~(b.loaded/b.total*100)+"%";a.log.info("loading("+e+"): "+c+"... "+f),d&&d()},j=[],k=Object.keys(b),l=0;l<k.length;l++)j[l]=[k[l],b[k[l]]];return{addBuffer:f,getBufferByName:function(a){return g.hasOwnProperty(a)?g[a]:null},getBufferByIndex:function(a){var b=Object.keys(g)[a];return void 0===typeof b?null:g[b]},getBufferNames:function(){return Object.keys(g)},load:function(){e(j,0)}}}a.log=function(){function a(a,b,c){var d=a+b;return c&&c.label&&(d+=" ("+c.label+")"),d}var b="[wx] ",c="[wx:info] ",d="[wx:warn] ",e="[wx:err] ",f=!1;return{verbose:function(a){"boolean"==typeof a&&(f=a)},post:function(c){console.log(a(b,c))},info:function(b,d){f&&console.log(a(c,b,d))},warn:function(b,c){f&&console.log(a(d,b,c))},error:function(b,c){throw new Error(a(e,b,c))}}}();var c=!1,d=!1;if(!window.hasOwnProperty("webkitAudioContext")&&!window.hasOwnProperty("AudioContext"))return a.log.error("AudioContext seems to be missing. Bye."),null;if(!window.hasOwnProperty("webkitAudioContext"))return a.log.error("WAAX currently does not support FireFox due to its incomplete implementation of Web Audio API. Use Chrome or Safari. bye."),null;c=!0,a.log.info("Web Audio API fully supported."),window.AudioContext=window.webkitAudioContext,AudioContext.prototype.hasOwnProperty("createGain")||(d=!0,a.log.info("adding legacy support on audio context..."));var e=new AudioContext,f=function(){};Object.defineProperties(a,{System:{value:{REVISION:"r13dev",API_AVAILABLE:c,LEGACY_SUPPORT:d}},context:{value:e},now:{get:function(){return e.currentTime},set:f},sampleRate:{get:function(){return e.sampleRate},set:f}}),Object.defineProperties(a,{patch:{value:function(){for(var a=0;a<arguments.length-1;a++)arguments[a].outlet.connect(arguments[a+1].inlet)}},$:{value:function(a,b,c,d,e){if("undefined"==typeof c)return a.setValueAtTime(b,0),void(a.value=b);switch(c){case 0:case"step":a.setValueAtTime(b,d);break;case 1:case"line":a.linearRampToValueAtTime(b,d);break;case 2:case"expo":a.exponentialRampToValueAtTime(b,d);break;case 3:case"target":a.setTargetAtTime(b,d,e)}}},extend:{value:function(a,b){for(var c in b)a[c]=b[c]}},clone:{value:function(a){var b={};for(var c in a)b[c]=a[c];return b}},random2f:{value:function(a,b){return a+Math.random()*(b-a)}},random2:{value:function(a,b){return Math.round(a+Math.random()*(b-a))}},clamp:{value:function(a,b,c){return Math.min(Math.max(a,b),c)}},pitch2freq:{value:function(a){return 440*Math.pow(2,(Math.floor(a)-69)/12)}},freq2pitch:{value:function(a){return Math.floor(69+12*Math.log(a/440)/.6931471805599453)}},lin2db:{value:function(a){return 20*(a>1e-5?Math.log(a)/2.302585092994046:-5)}},db2lin:{value:function(a){return Math.pow(10,a/20)}}}),a.nGain=function(){return e.createGain()},a.nDelay=function(){return e.createDelay()},a.nFilter=function(){return e.createBiquadFilter()},a.nComp=function(){return e.createDynamicsCompressor()},a.nConvolver=function(){return e.createConvolver()},a.nWaveShaper=function(){return e.createWaveShaper()},a.nSource=function(){return e.createBufferSource()},a.nOSC=function(){return e.createOscillator()},a.nAnalyzer=function(){return e.createAnalyser()},a.nPanner=function(){return e.createPanner()},a.nSplitter=function(a){return e.createChannelSplitter(a)},a.nMerger=function(a){return e.createChannelMerger(a)},a.nPeriodicWave=function(){return e.createPeriodicWave()},a.nBuffer=function(a,b,c){return e.createBuffer(a,b,c)},a.OscilType={sine:0,square:1,sawtooth:2,triangle:3,custom:4},a.UnitBase=function(){this.params={pLabel:"Unit",pActive:!0},this._nActive=a.nGain()},a.UnitBase.prototype={set:function(a,b,c,d,e){if(this.params.hasOwnProperty(a)){this.params[a]=b;var f="_"+a.slice(1);"function"==typeof this[f]&&this[f](c,d,e)}return this},get:function(a){return this.params.hasOwnProperty(a)?this.params[a]:null},setParams:function(a){for(var b in a)this.set(b,a[b]);return this},getParams:function(){return a.clone(this.params)},_Active:function(){this._nActive.gain.value=this.params.pActive?1:0,this._nBypass&&(this._nBypass.gain.value=this.params.pActive?0:1)}},a.UnitInput=function(){this.params.pInputGain=1,this.inlet=a.nGain(),this._nInput=a.nGain(),this._nBypass=a.nGain(),this.inlet.connect(this._nInput),this.inlet.connect(this._nBypass)},a.UnitInput.prototype={_InputGain:function(b,c,d){a.$(this._nInput.gain,this.params.pInputGain,b,c,d)}},a.UnitOutput=function(){this.params.pGain=1,this._nOutput=a.nGain(),this._nActive=a.nGain(),this.outlet=a.nGain(),this._nOutput.connect(this._nActive),this._nActive.connect(this.outlet),this._nBypass&&this._nBypass.connect(this.outlet)},a.UnitOutput.prototype={to:function(b){return b.inlet?(this.outlet.connect(b.inlet),b):void a.log.error("invalid unit.")},connect:function(a){this.outlet.connect(a)},control:function(a,b){if(!a._modulationTargets.hasOwnProperty(b))return null;for(var c=a._modulationTargets[b],d=0;d<c.length;d++)this.outlet.connect(c[d])},_Gain:function(b,c,d){a.$(this._nOutput.gain,this.params.pGain,b,c,d)}},a.BufferMap=function(a,c,d){return b(a,c,d)},a.log.post("WAAX core loaded. ("+a.System.REVISION+")")}(window.WX),function(a){function b(b){a.UnitBase.call(this),a.UnitInput.call(this),a.UnitOutput.call(this),a.extend(this.params,this.defaultParams),a.extend(this.params,b),this._nInput.connect(this._nOutput),this._TimeConstant(),this.set("pInputGain",0),this._sustainOnset=0,this.setParams(this.params)}b.prototype={defaultParams:{pLabel:"ADSR",pAttack:.005,pDecay:.015,pSustain:.75,pRelease:.05,pTimeConstant:.01,pMode:"polyphonic"},_TimeConstant:function(){this._tau=-Math.log(this.params.pTimeConstant)},setADSR:function(a,b,c,d){this.setParams({pAttack:a,pDecay:b,pSustain:c,pRelease:d})},noteOn:function(b){var c=this._nInput.gain,d=this.params;b=b||a.now,this._sustainOnset=b+d.pAttack+d.pDecay,"monophonic"===this.params.pMode?(c.cancelScheduledValues(b),c.setValueAtTime(c.value,b),c.linearRampToValueAtTime(1,b+d.pAttack)):(c.setValueAtTime(0,b),c.linearRampToValueAtTime(1,b+d.pAttack)),c.exponentialRampToValueAtTime(d.pSustain,this._sustainOnset)},noteOff:function(b){var c=this._nInput.gain,d=this.params;b=b||a.now;var e=b>this._sustainOnset?b:this._sustainOnset;c.cancelScheduledValues(e),c.setTargetAtTime(1e-4,e,d.pRelease/this._tau)}},a.extend(b.prototype,a.UnitBase.prototype),a.extend(b.prototype,a.UnitInput.prototype),a.extend(b.prototype,a.UnitOutput.prototype),a.ADSR=function(a){return new b(a)}}(WX),function(a){function b(b){a.UnitBase.call(this),a.UnitInput.call(this),a.UnitOutput.call(this),a.extend(this.params,this.defaultParams),a.extend(this.params,b),this._nDry=a.nGain(),this._nWet=a.nGain();var c=a.nSplitter(2),d=a.nMerger(2);this._nLStream=a.nGain(),this._nLDelayV=a.nDelay(),this._nLDelayF=a.nDelay(),this._nLFeedback=a.nGain(),this._nLFeedforward=a.nGain(),this._nLBlend=a.nGain(),this._nRStream=a.nGain(),this._nRDelayV=a.nDelay(),this._nRDelayF=a.nDelay(),this._nRFeedback=a.nGain(),this._nRFeedforward=a.nGain(),this._nRBlend=a.nGain(),this._nInput.connect(c),this._nInput.connect(this._nDry),c.connect(this._nLStream,0,0),this._nLStream.connect(this._nLDelayF),this._nLStream.connect(this._nLDelayV),this._nLDelayF.connect(this._nLFeedback),this._nLFeedback.connect(this._nLStream),this._nLDelayV.connect(this._nLFeedforward),this._nLDelayV.connect(d,0,0),this._nLBlend.connect(d,0,0),c.connect(this._nRStream,1,0),this._nRStream.connect(this._nRDelayF),this._nRStream.connect(this._nRDelayV),this._nRDelayF.connect(this._nRFeedback),this._nRFeedback.connect(this._nRStream),this._nRDelayV.connect(this._nRFeedforward),this._nRDelayV.connect(d,0,1),this._nRBlend.connect(d,0,1),d.connect(this._nWet),this._nDry.connect(this._nOutput),this._nWet.connect(this._nOutput),this._nLFO=a.nOSC(),this._nLDepth=a.nGain(),this._nRDepth=a.nGain(),this._nLFO.start(0),this._nLFO.connect(this._nLDepth),this._nLFO.connect(this._nRDepth),this._nLDepth.connect(this._nLDelayV.delayTime),this._nRDepth.connect(this._nRDelayV.delayTime),this._nLFO.type="sine",this._nLFO.frequency.value=.18,this._nLDepth.gain.value=.01,this._nRDepth.gain.value=-.011,this._nLDelayV.delayTime.value=.017,this._nLDelayF.delayTime.value=.011,this._nRDelayV.delayTime.value=.013,this._nRDelayF.delayTime.value=.019,this._nLFeedforward.gain.value=.70701,this._nRFeedforward.gain.value=.70701,this.setParams(this.params)}b.prototype={defaultParams:{pLabel:"Chorus",pRate:.1,pDepth:1,pIntensity:.1,pBlend:1,pMix:.6},_Rate:function(b,c,d){var e=.01*(29*a.clamp(this.params.pRate,0,1)+1);a.$(this._nLFO.frequency,e,b,c,d)},_Depth:function(b,c,d){var e=.05*this.params.pDepth;a.$(this._nLDepth.gain,e,b,c,d),a.$(this._nRDepth.gain,-e,b,c,d)},_Intensity:function(b,c,d){var e=-this.params.pIntensity;a.$(this._nLFeedback.gain,e,b,c,d),a.$(this._nRFeedback.gain,e,b,c,d)},_Blend:function(b,c,d){a.$(this._nLBlend.gain,this.params.pBlend,b,c,d),a.$(this._nRBlend.gain,this.params.pBlend,b,c,d)},_Mix:function(b,c,d){a.$(this._nDry.gain,1-this.params.pMix,b,c,d),a.$(this._nWet.gain,this.params.pMix,b,c,d)}},a.extend(b.prototype,a.UnitBase.prototype),a.extend(b.prototype,a.UnitInput.prototype),a.extend(b.prototype,a.UnitOutput.prototype),a.Chorus=function(a){return new b(a)}}(WX),function(a){function b(b){a.UnitBase.call(this),a.UnitInput.call(this),a.UnitOutput.call(this),a.extend(this.params,this.defaultParams),a.extend(this.params,b),this._nComp=a.nComp(),this._nInput.connect(this._nComp),this._nComp.connect(this._nOutput),this.setParams(this.params)}b.prototype={defaultParams:{pLabel:"Comp",pThreshold:-8,pKnee:0,pRatio:2,pAttack:.01,pRelease:.25,pGain:1},_Threshold:function(b,c,d){a.$(this._nComp.threshold,this.params.pThreshold,b,c,d)},_Knee:function(b,c,d){a.$(this._nComp.knee,this.params.pKnee,b,c,d)},_Ratio:function(b,c,d){a.$(this._nComp.ratio,this.params.pRatio,b,c,d)},_Attack:function(b,c,d){a.$(this._nComp.attack,this.params.pAttack,b,c,d)},_Release:function(b,c,d){a.$(this._nComp.release,this.params.pRelease,b,c,d)}},a.extend(b.prototype,a.UnitBase.prototype),a.extend(b.prototype,a.UnitInput.prototype),a.extend(b.prototype,a.UnitOutput.prototype),a.Comp=function(a){return new b(a)}}(WX),function(a){function b(b){a.UnitBase.call(this),a.UnitInput.call(this),a.UnitOutput.call(this),a.extend(this.params,this.defaultParams),a.extend(this.params,b),this._nDry=a.nGain(),this._nWet=a.nGain(),this._nConvolver=a.nConvolver(),this._nInput.connect(this._nDry),this._nInput.connect(this._nConvolver),this._nConvolver.connect(this._nWet),this._nDry.connect(this._nOutput),this._nWet.connect(this._nOutput),this.setParams(this.params)}b.prototype={defaultParams:{pLabel:"Converb",pMix:.2},_Mix:function(b,c,d){a.$(this._nDry.gain,1-this.params.pMix,b,c,d),a.$(this._nWet.gain,this.params.pMix,b,c,d)},setImpulseResponse:function(a){this._nConvolver.buffer=a}},a.extend(b.prototype,a.UnitBase.prototype),a.extend(b.prototype,a.UnitInput.prototype),a.extend(b.prototype,a.UnitOutput.prototype),a.Converb=function(a){return new b(a)}}(WX),function(a){function b(b){a.UnitBase.call(this),a.UnitOutput.call(this),a.extend(this.params,this.defaultParams),a.extend(this.params,b),this._nMod=a.nOSC(),this._nModGain=a.nGain(),this._nCar=a.nOSC(),this._nMod.connect(this._nModGain),this._nModGain.connect(this._nCar.frequency),this._nCar.connect(this._nOutput),this.setParams(this.params),this.params.pDynamic||this.start()}b.prototype={defaultParams:{pLable:"FMop",pFreq:440,pHarmonicRatio:4,pModulationIndex:.1,pDynamic:!1},_Freq:function(b,c,d){a.$(this._nCar.frequency,this.params.pFreq,b,c,d)},_HarmonicRatio:function(b,c,d){a.$(this._nMod.frequency,this.params.pFreq*this.params.pHarmonicRatio,b,c,d)},_ModulationIndex:function(b,c,d){a.$(this._nModGain.gain,this.params.pFreq*this.params.pHarmonicRatio*this.params.pModulationIndex,b,c,d)},start:function(b){this.params.pDynamic&&(this._nMod=a.nOSC(),this._nModGain=a.nGain(),this._nCar=a.nOSC(),this._nMod.connect(this._nModGain),this._nModGain.connect(this._nCar.frequency),this._nCar.connect(this._nOutput)),this._nMod.start(b||a.now),this._nCar.start(b||a.now)},stop:function(b){this._nMod.stop(b||a.now),this._nCar.stop(b||a.now)}},a.extend(b.prototype,a.UnitBase.prototype),a.extend(b.prototype,a.UnitOutput.prototype),a.FMop=function(a){return new b(a)}}(WX),function(a){function b(b){a.UnitBase.call(this),a.UnitInput.call(this),a.UnitOutput.call(this),a.extend(this.params,this.defaultParams),a.extend(this.params,b),this._nInput.connect(this._nOutput),this._modulationTargets={pGain:[this._nOutput.gain]},this.setParams(this.params)}b.prototype={defaultParams:{pLabel:"Fader",pMute:!1,pdB:0},_Mute:function(){a.$(this._nInput.gain,this.params.pMute?0:1)},_Gain:function(b,c,d){this.params.pdB=a.lin2db(this.params.pGain),a.$(this._nOutput.gain,this.params.pGain,b,c,d)},_dB:function(b,c,d){this.params.pGain=a.db2lin(this.params.pdB),a.$(this._nOutput.gain,this.params.pGain,b,c,d)}},a.extend(b.prototype,a.UnitBase.prototype),a.extend(b.prototype,a.UnitInput.prototype),a.extend(b.prototype,a.UnitOutput.prototype),a.Fader=function(a){return new b(a)},a.DAC=a.Fader({pLabel:"DAC"}),a.DAC.connect(a.context.destination)}(WX),function(a){function b(b){a.UnitBase.call(this),a.UnitInput.call(this),a.UnitOutput.call(this),a.extend(this.params,this.defaultParams),a.extend(this.params,b),this._nFilters1=[],this._nFilters2=[],this._nGains=[],this._nSumming=a.nGain();for(var c=0;d>c;++c)this._nFilters1[c]=a.nFilter(),this._nFilters2[c]=a.nFilter(),this._nGains[c]=a.nGain(),this._nFilters1[c].type="bandpass",this._nFilters2[c].type="bandpass",this._nInput.connect(this._nFilters1[c]),this._nFilters1[c].connect(this._nFilters2[c]),this._nFilters2[c].connect(this._nGains[c]),this._nGains[c].connect(this._nSumming);this._nSumming.connect(this._nOutput),this._nSumming.gain.value=50,this.setParams(this.params)}var c={ionian:[0,7,14,21,28,35,43,48],lydian:[0,6,16,21,26,35,42,48],aeolian:[0,7,15,22,26,34,39,48],mixolydian:[0,5,16,23,26,33,41,48]},d=8;b.prototype={defaultParams:{pLabel:"FilterBank",pPitch:41,pChord:"lydian",pSlope:.26,pWidth:.49,pDetune:0},_setFilterFrequency:function(b,e,f){for(var g=a.pitch2freq(this.params.pPitch),h=c[this.params.pChord],i=0;d>i;++i){var j=g*Math.pow(2,h[i]/12);a.$(this._nFilters1[i].frequency,j,b,e,f),a.$(this._nFilters2[i].frequency,j,b,e,f)}},_Pitch:function(a,b,c){this._setFilterFrequency(a,b,c)},_Chord:function(a,b,c){this._setFilterFrequency(a,b,c)},_Slope:function(b,c,e){this.params.pSlope=a.clamp(this.params.pSlope,.1,.75);for(var f=0;d>f;++f){var g=1+Math.sin(Math.PI+Math.PI/2*(this.params.pSlope+f/d));a.$(this._nGains[f].gain,g,b,c,e)}},_Width:function(b,c,e){for(var f=0;d>f;++f){var g=2+90*Math.pow(1-f/d,this.params.pWidth);a.$(this._nFilters1[f].Q,g,b,c,e),a.$(this._nFilters2[f].Q,g,b,c,e)}},_Detune:function(b,c,e){for(var f=0;d>f;++f)a.$(this._nFilters1[f].detune,this.params.pDetune,b,c,e),a.$(this._nFilters2[f].detune,-this.params.pDetune,b,c,e)}},a.extend(b.prototype,a.UnitBase.prototype),a.extend(b.prototype,a.UnitInput.prototype),a.extend(b.prototype,a.UnitOutput.prototype),a.FilterBank=function(a){return new b(a)}}(WX),function(a){function b(b){a.UnitBase.call(this),a.UnitInput.call(this),a.UnitOutput.call(this),a.extend(this.params,this.defaultParams),a.extend(this.params,b),this._nFilters=[],this._nGains=[];for(var c=0;5>c;++c)this._nFilters[c]=a.nFilter(),this._nGains[c]=a.nGain(),this._nFilters[c].type="bandpass",this._nInput.connect(this._nFilters[c]),this._nFilters[c].connect(this._nGains[c]),this._nGains[c].connect(this._nOutput);this._tFreq=[],this._tQ=[],this._tAmp=[],this.setParams(this.params)}var c={a:{freq:[800,1150,2800,3500,4950],bw:[80,90,120,130,140],amp:[1,.6309573444801932,.1,.015848931924611134,.001]},e:{freq:[400,1600,2700,3300,4950],bw:[60,80,120,150,200],amp:[1,.06309573444801933,.03162277660168379,.01778279410038923,.001]},i:{freq:[350,1700,2700,3700,4950],bw:[50,100,120,150,200],amp:[1,.1,.03162277660168379,.015848931924611134,.001]},o:{freq:[450,800,2830,3500,4950],bw:[70,80,100,130,135],amp:[1,.35481338923357547,.15848931924611134,.039810717055349734,.0017782794100389228]},u:{freq:[325,700,2530,3500,4950],bw:[50,60,170,180,200],amp:[1,.251188643150958,.03162277660168379,.01,.000630957344480193]}},d=[[0,1],[-.9510565162951535,.3090169943749475],[-.5877852522924732,-.8090169943749473],[.5877852522924729,-.8090169943749476],[.9510565162951536,.3090169943749472]];b.prototype={defaultParams:{pPositionX:0,pPositionY:.1},_calculateFormant:function(a,b){for(var e=[],f=0,g=0;5>g;g++){var h=a-d[g][0],i=b-d[g][1],j=Math.sqrt(h*h+i*i);0===j?j=1e-4:(e[g]=1/j,f+=e[g])}f=1/f;for(var k=0;5>k;k++)this._tFreq[k]=e[0]*c.a.freq[k]+e[1]*c.e.freq[k]+e[2]*c.i.freq[k]+e[3]*c.o.freq[k]+e[4]*c.u.freq[k],this._tFreq[k]*=f,this._tQ[k]=e[0]*c.a.freq[k]/c.a.bw[k]+e[1]*c.e.freq[k]/c.e.bw[k]+e[2]*c.i.freq[k]/c.i.bw[k]+e[3]*c.o.freq[k]/c.o.bw[k]+e[4]*c.u.freq[k]/c.u.bw[k],this._tQ[k]*=f,this._tAmp[k]=e[0]*c.a.amp[k]+e[1]*c.e.amp[k]+e[2]*c.i.amp[k]+e[3]*c.o.amp[k]+e[4]*c.u.amp[k],this._tAmp[k]*=f},_PositionX:function(){},_PositionY:function(){},setPosition:function(b,c,d,e,f){this._calculateFormant(b,c);for(var g=0;5>g;g++)a.$(this._nFilters[g].frequency,this._tFreq[g],d,e,f),a.$(this._nFilters[g].Q,this._tQ[g],d,e,f),a.$(this._nGains[g].gain,this._tAmp[g],d,e,f)}},a.extend(b.prototype,a.UnitBase.prototype),a.extend(b.prototype,a.UnitInput.prototype),a.extend(b.prototype,a.UnitOutput.prototype),a.FormantV=function(a){return new b(a)}}(WX),function(a){function b(b){a.UnitBase.call(this),a.UnitOutput.call(this),a.extend(this.params,this.defaultParams),a.extend(this.params,b),this._nImpulseTrain=a.nOSC(),this._nImpulseTrain.connect(this._nOutput),this._modulationTargets={pFreq:[this._nImpulseTrain.frequency],pGain:[this._nOutput.gain]},"undefined"==typeof this._nImpulseTrain.setWaveTable?this._nImpulseTrain.setPeriodicWave(f):this._nImpulseTrain.setWaveTable(f),this.setParams(this.params),this.params.pDynamic||this.start()}var c=4096,d=new Float32Array(c),e=new Float32Array(c);for(i=0;c>i;++i)d[i]=1,e[i]=0;var f;f="function"==typeof a.context.createWaveTable?a.context.createWaveTable(d,e):a.context.createPeriodicWave(d,e),b.prototype={defaultParams:{pLabel:"ImpulseTrain",pFreq:1,pGain:.25,pDynamic:!1},_Freq:function(b,c,d){a.$(this._nImpulseTrain.frequency,this.params.pFreq,b,c,d)},start:function(b){this.params.pDynamic&&(this._nImpulseTrain=a.nOSC(),this._nImpulseTrain.connect(this._nOutput),"undefined"==typeof this._nImpulseTrain.setWaveTable?this._nImpulseTrain.setPeriodicWave(f):this._nImpulseTrain.setWaveTable(f),this.setParams(this.params)),this._nImpulseTrain.start(b||a.now)},stop:function(b){this._nImpulseTrain.stop(b||a.now)}},a.extend(b.prototype,a.UnitBase.prototype),a.extend(b.prototype,a.UnitOutput.prototype),a.ImpulseTrain=function(a){return new b(a)}}(WX),Ktrl=function(){function a(a){this.input=a,this.targets=[];var b=this;this.input.onmidimessage=function(a){for(var c=b.targets.length;c--;)b.targets[c].ondata(a)}}function b(a){this.id=y++,this.label=a||"Untitled",this.active=!1,this.process=function(){};var b=this;this.ondata=function(a){b.active&&b.process(a)},x.push(this)}function c(a){return new b(a)}function d(a){return w.map(function(b){b.addTarget(a)}),!0}function e(a,b){return a<w.length?(w.map(function(a){a.removeTarget(b)}),w[a].addTarget(b),!0):(j("invalid source id or target."),!1)}function f(a){return w.map(function(b){b.removeTarget(a)}),!0}function g(a){return Ktrl.disconnectTarget(a)?(x.map(function(b){if(b===a){var c=x.indexOf(a);x.splice(c,1)}}),!0):!1}function h(a){"function"!=typeof a?j("invalid handler function."):(v&&i(),z=a)}function i(){var a=0;j("listing available MIDI sources..."),w.map(function(b){console.log("source",a++,"	",b.input.name,"	",b.input.manufacturer)}),j("listing available MIDI targets..."),x.map(function(a){console.log("target",a.id,"	",a.label,"	",a.active)})}function j(a){console.log("[ktrl] "+a)}function k(a,b,c){return a*((c||1)-(b||0))+(b||0)}function l(a){return C.linear[a]}function m(a){return C.smooth[a]}function n(a){return C.smooth2[a]}function o(a){return C.sqaured[a]}function p(a){return C.cubed[a]}function q(a){return C.invSquared[a]}function r(a){return C.invCubed[a]}function s(a){return C.sine[a]}function t(a){return C.invSine[a]}function u(){"function"==typeof z?(j("executing onReady!"),z()):(j("onReady is not specified. Wait for it..."),setTimeout(u,1e3))}var v=!0,w=[],x=[],y=0,z=null,A=!1,B="r1";"undefined"==typeof navigator.requestMIDIAccess&&(v=!1),a.prototype={constructor:a,removeTarget:function(a){var b=this;this.targets.map(function(c){if(c===a){var d=b.targets.indexOf(a);b.targets.splice(d,1)}})},addTarget:function(a){for(var b=0;b<this.targets.length;++b)if(this.targets[b]===a)return void j("duplicate target.");this.targets.push(a)}},b.prototype={constructor:b,onData:function(a){this.process=a},activate:function(){this.active=!0},disable:function(){this.active=!1},getID:function(){return this.id}},parse=function(a){var b,c=a.data,d=.001*a.timeStamp,e=c[0]>>4,f=(15&c[0])+1;switch(e){case 8:b={type:"noteoff",channel:f,pitch:c[1],velocity:c[2],timestamp:d};break;case 9:b={type:"noteon",channel:f,pitch:c[1],velocity:c[2],timestamp:d};break;case 10:b={type:"polypressure",channel:f,pitch:c[1],pressure:c[2],timestamp:d};break;case 11:b={type:"controlchange",channel:f,control:c[1],value:c[2],timestamp:d};break;case 12:b={type:"programchange",channel:f,program:c[1],timestamp:d};break;case 13:b={type:"channelpressure",channel:f,pressure:c[1],timestamp:d};break;case 14:b={type:"pitchwheel",channel:f,wheel:c[1]<<8|c[2],timestamp:d}}return b};for(var C={linear:new Array(128),smooth:new Array(128),smooth2:new Array(128),sqaured:new Array(128),cubed:new Array(128),invSquared:new Array(128),invCubed:new Array(128),sine:new Array(128),invSine:new Array(128)},D=0;128>D;D++){var E=D/127;C.linear[D]=E,C.smooth[D]=E*E*(3-2*E),C.smooth2[D]=C.smooth[D]*C.smooth[D]*(3-2*C.smooth[D]),C.sqaured[D]=E*E,C.cubed[D]=E*E*E,C.invSquared[D]=1-(1-E)*(1-E),C.invCubed[D]=1-(1-E)*(1-E)*(1-E),C.sine[D]=Math.sin(E*Math.PI/2),C.invSine[D]=1-Math.sin(E*Math.PI/2+Math.PI/2)}var F={A0:21,B0:23,C1:24,D1:26,E1:28,F1:29,G1:31,A1:33,B1:35,C2:36,D2:38,E2:40,F2:41,G2:43,A2:45,B2:47,C3:48,D3:50,E3:52,F3:53,G3:55,A3:57,B3:59,C4:60,D4:62,E4:64,F4:65,G4:67,A4:69,B4:71,C5:72,D5:74,E5:76,F5:77,G5:79,A5:81,B5:83,C6:84,D6:86,E6:88,F6:89,G6:91,A6:93,B6:95,C7:96,D7:98,E7:100,F7:101,G7:103,A7:105,B7:107,C8:108};return v?navigator.requestMIDIAccess().then(function(b){if(0===b.inputs().length)return void j("no input ports available");for(var c=0;c<b.inputs().length;++c)w[c]=new a(b.inputs()[c]);j("Ktrl ("+B+") is ready."),A=!0,u()},function(a){j("failed to get MIDI access: "+a),A=!1}):j("Your browser does not support MIDI. Ktrl is inactive."),{createTarget:c,removeTarget:g,disconnectTarget:f,routeAllToTarget:d,routeSourceToTarget:e,ready:h,parse:parse,report:i,scale:k,CurveLinear:l,CurveSmooth:m,CurveSmooth2:n,CurveSquared:o,CurveCubed:p,CurveInvSquared:q,CurveInvCubed:r,CurveSine:s,CurveInvSine:t,NoteName:F}}(),function(a){function b(b){a.UnitBase.call(this),a.UnitInput.call(this),a.UnitOutput.call(this),a.extend(this.params,this.defaultParams),a.extend(this.params,b),this._nFilter1=a.nFilter(),this._nFilter2=a.nFilter(),this._nFilter1.type=this._nFilter2.type="lowpass",this._nInput.connect(this._nFilter1),this._nFilter1.connect(this._nOutput),this._nFilter2.connect(this._nOutput),this._modulationTargets={pCutoff:[this._nFilter1.frequency,this._nFilter2.frequency],pQ:[this._nFilter1.Q,this._nFilter2.Q]},this.setParams(this.params)}b.prototype={defaultParams:{pCutoff:250,pQ:0,pEnhanced:!1},_Cutoff:function(b,c,d){a.$(this._nFilter1.frequency,this.params.pCutoff,b,c,d),a.$(this._nFilter2.frequency,this.params.pCutoff,b,c,d)},_Q:function(b,c,d){a.$(this._nFilter1.Q,this.params.pQ,b,c,d),a.$(this._nFilter2.Q,this.params.pQ,b,c,d)},_Enhanced:function(a){this._nFilter1.disconnect(),this._nFilter1.connect(a?this._nFilter2:this._nOutput)}},a.extend(b.prototype,a.UnitBase.prototype),a.extend(b.prototype,a.UnitInput.prototype),a.extend(b.prototype,a.UnitOutput.prototype),a.LPF=function(a){return new b(a)}}(WX),function(a){function b(b,c){for(var d=Math.floor(a.sampleRate*b),e=new Float32Array(d),f=0;d>f;f++){var g=Math.random(),h=Math.random();e[f]=Math.sqrt(-2*Math.log(g))*Math.cos(2*Math.PI*h)*.5}var i=a.context.createBuffer(2,d,c);return i.getChannelData(0).set(e,0),i.getChannelData(1).set(e,0),i}function c(c){a.UnitBase.call(this),a.UnitOutput.call(this),a.extend(this.params,this.defaultParams),a.extend(this.params,c),this._noiseBuffer=b(9.73,a.sampleRate),this.__init(),this._modulationTargets={pGain:[this._nOutput.gain]},this.setParams(this.params),this.params.pDynamic||this.start()}var d=10,e=b(d,a.sampleRate);c.prototype={defaultParams:{pLabel:"Noise",pGrain:1,pGain:.1,pDynamic:!1},__init:function(){this._nNoise1=a.nSource(),this._nNoise2=a.nSource(),this._nNoise1.connect(this._nOutput),this._nNoise2.connect(this._nOutput),this._nNoise1.buffer=e,this._nNoise2.buffer=this._noiseBuffer,this._nNoise1.loop=!0,this._nNoise2.loop=!0,this._nNoise1.loopStart=Math.random()*e.duration,this._nNoise2.loopStart=Math.random()*this._noiseBuffer.duration},_Grain:function(b,c,d){a.$(this._nNoise1.playbackRate,this.params.pGrain,b,c,d),a.$(this._nNoise2.playbackRate,this.params.pGrain,b,c,d)},start:function(b){this.params.pDynamic&&this.__init(),this._nNoise1.start(b||a.now),this._nNoise2.start(b||a.now)},stop:function(b){this._nNoise1.stop(b||a.now),this._nNoise2.stop(b||a.now)}},a.extend(c.prototype,a.UnitBase.prototype),a.extend(c.prototype,a.UnitOutput.prototype),a.Noise=function(a){return new c(a)}}(WX),function(a){function b(b){a.UnitBase.call(this),a.UnitOutput.call(this),a.extend(this.params,this.defaultParams),a.extend(this.params,b),this._nOSC=a.nOSC(),this._nOSC.connect(this._nOutput),this._modulationTargets={pFreq:[this._nOSC.frequency],pGain:[this._nOutput.gain]},this.setParams(this.params),this.params.pDynamic||this.start()}b.prototype={defaultParams:{pLabel:"Oscil",pType:"sine",pFreq:440,pGain:.25,pDynamic:!1},_Type:function(){this._nOSC.type=a.System.LEGACY_SUPPORT?a.OscilType[this.params.pType]:this.params.pType},_Freq:function(b,c,d){a.$(this._nOSC.frequency,this.params.pFreq,b,c,d)},start:function(b){this.params.pDynamic&&(this._nOSC=a.nOSC(),this._nOSC.connect(this._nOutput),this.setParams(this.params)),this._nOSC.start(b||a.now)},stop:function(b){this._nOSC.stop(b||a.now)}},a.extend(b.prototype,a.UnitBase.prototype),a.extend(b.prototype,a.UnitOutput.prototype),a.Oscil=function(a){return new b(a)}}(WX),function(a){function b(b){a.UnitBase.call(this),a.UnitInput.call(this),a.UnitOutput.call(this),a.extend(this.params,this.defaultParams),a.extend(this.params,b),this._nDry=a.nGain(),this._nWet=a.nGain();var d=a.nSplitter(),e=a.nMerger();this._nNotches=[];for(var f=0;c>f;f++)this._nNotches[f]=a.nFilter(),this._nNotches[f].type="notch";this._inputGain.connect(this._nDry),this._inputGain.connect(d),d.connect(this._nNotches[0],0,0),d.connect(this._nNotches[1],1,0);for(var g=0;c-2>g;g+=2)this._nNotches[g].connect(this._nNotches[g+2]),this._nNotches[g+1].connect(this._nNotches[g+3]);this._nNotches[c-2].connect(e,0,0),this._nNotches[c-1].connect(e,0,1),e.connect(this._nWet),this._nDry.connect(this._nOutput),this._nWet.connect(this._nOutput),this._nLFO=a.nOSC(),this._nLDepth=a.nGain(),this._nRDepth=a.nGain(),this._nLFO.start(0),this._nLFO.connect(this._nLDepth),this._nLFO.connect(this._nRDepth);for(var h=0;c>h;h++)h%2?this._nRDepth.connect(this._nNotches[h].frequency):this._nLDepth.connect(this._nNotches[h].frequency);this._nLFO.type="triangle",this.setParams(this.params)}var c=12;b.prototype={defaultParams:{pLabel:"Phasor",pRate:.5,pDepth:1,pBaseFrequency:1,pSpacing:.1,pMix:.6},_setNotchFrequency:function(){for(var b=0;c>b;b++){var d=this.params.pBaseFrequency+Math.pow(this.params.pSpacing,b);a.$(this._nNotches[b].frequency,d,transType,time1,time2)}},_Rate:function(b,c,d){a.$(this._nLFO.frequency,4*a.clamp(this.params.pRate,0,1)+2,b,c,d)},_Depth:function(b,c,d){var e=200*a.clamp(this.params.pDepth,0,1);a.$(this._nLDepth.gain,e,b,c,d),a.$(this._nRDepth.gain,-e,b,c,d)},_BaseFrequency:function(){this._setNotchFrequency()},_Spacing:function(){this._setNotchFrequency()},_Mix:function(b,c,d){a.$(this._nDry.gain,1-this.params.pMix,b,c,d),a.$(this._nWet.gain,this.params.pMix,b,c,d)}},a.extend(b.prototype,a.UnitBase.prototype),a.extend(b.prototype,a.UnitInput.prototype),a.extend(b.prototype,a.UnitOutput.prototype),a.Phasor=function(a){return new b(a)}}(WX),function(a){function b(b){a.UnitBase.call(this),a.UnitInput.call(this),a.UnitOutput.call(this),a.extend(this.params,this.defaultParams),a.extend(this.params,b),this._nLDelay=a.nDelay(),this._nRDelay=a.nDelay(),this._nLFeedback=a.nGain(),this._nRFeedback=a.nGain(),this._nLCrosstalk=a.nGain(),this._nRCrosstalk=a.nGain(),this._nDry=a.nGain(),this._nWet=a.nGain();var c=a.nSplitter(2),d=a.nMerger(2);this._nInput.connect(c),this._nInput.connect(this._nDry),c.connect(this._nLDelay,0,0),this._nLDelay.connect(this._nLFeedback),this._nLFeedback.connect(this._nLDelay),this._nLFeedback.connect(this._nRCrosstalk),this._nRCrosstalk.connect(this._nRDelay),this._nLDelay.connect(d,0,0),c.connect(this._nRDelay,1,0),this._nRDelay.connect(this._nRFeedback),this._nRFeedback.connect(this._nRDelay),this._nRFeedback.connect(this._nLCrosstalk),this._nLCrosstalk.connect(this._nLDelay),this._nRDelay.connect(d,0,1),d.connect(this._nWet),this._nDry.connect(this._nOutput),this._nWet.connect(this._nOutput),this.setParams(this.params)}b.prototype={defaultParams:{pLabel:"Pingpong",pDelayTimeLeft:.125,pDelayTimeRight:.25,pFeedbackLeft:.25,pFeedbackRight:.125,pCrosstalk:.1,pMix:1},_DelayTimeLeft:function(b,c,d){a.$(this._nLDelay.delayTime,this.params.pDelayTimeLeft,b,c,d)},_DelayTimeRight:function(b,c,d){a.$(this._nRDelay.delayTime,this.params.pDelayTimeRight,b,c,d)},_FeedbackLeft:function(b,c,d){a.$(this._nLFeedback.gain,this.params.pFeedbackLeft,b,c,d)},_FeedbackRight:function(b,c,d){a.$(this._nRFeedback.gain,this.params.pFeedbackRight,b,c,d)},_Crosstalk:function(b,c,d){a.$(this._nLCrosstalk.gain,this.params.pCrosstalk,b,c,d),a.$(this._nRCrosstalk.gain,this.params.pCrosstalk,b,c,d)},_Mix:function(b,c,d){a.$(this._nDry.gain,1-this.params.pMix,b,c,d),a.$(this._nWet.gain,this.params.pMix,b,c,d)},setDelayTime:function(a,b,c,d,e){this.set("pDelayTimeLeft",a,c,d,e),this.set("pDelayTimeLeft",b,c,d,e)},setFeedback:function(a,b,c,d,e){this.set("pFeedbackLeft",a,c,d,e),this.set("pFeedbackRight",b,c,d,e)}},a.extend(b.prototype,a.UnitBase.prototype),a.extend(b.prototype,a.UnitInput.prototype),a.extend(b.prototype,a.UnitOutput.prototype),a.Pingpong=function(a){return new b(a)}}(WX),function(a){function b(b){a.UnitBase.call(this),a.UnitOutput.call(this),a.extend(this.params,this.defaultParams),a.extend(this.params,b),this._buffer=null,this._nBufferSource=null,this.setParams(b)}b.prototype={defaultParams:{pPitch:60,pBasePitch:60,pLoop:!1,pGain:1},onload:function(){},setBuffer:function(a){"AudioBuffer"===a.constructor.name&&(this._buffer=a,this.onload())},getDuration:function(){return this._buffer?this._buffer.duration:0},oneshot:function(b,c){if(this._buffer){b=b||a.now,c=c||this._buffer.duration;var d=a.nSource();d.buffer=this._buffer,d.connect(this._nOutput);
var e=Math.pow(2,(this.params.pPitch-this.params.pBasePitch)/12);d.playbackRate.setValueAtTime(e,b),d.start(b),d.stop(b+c)}},start:function(b){if(this._buffer&&null===this._nBufferSource){b=b||a.now,this._nBufferSource=a.nSource(),this._nBufferSource.buffer=this._buffer,this._nBufferSource.loop=this.params.pLoop,this._nBufferSource.connect(this._nOutput);var c=Math.pow(2,(this.params.pPitch-this.params.pBasePitch)/12);this._nBufferSource.playbackRate.setValueAtTime(c,b),this._nBufferSource.start(b)}},stop:function(b){this._nBufferSource&&(b=b||a.now,this._nBufferSource.stop(b),this._nBufferSource=null)}},a.extend(b.prototype,a.UnitBase.prototype),a.extend(b.prototype,a.UnitOutput.prototype),a.Sampler=function(a){return new b(a)}}(WX),function(a){function b(a,b){for(var c=e,f=0;d>c;c++,f++){var g=c/d*2-1;if(b>g)a[c]=g,a[e-f]=-g;else{var h=b+(g-b)/(1+(g-b)/(1-b)^2);a[c]=h,a[e-f]=-h}a[c]*=1/((b+1)/2),a[e-f]*=1/((b+1)/2)}}function c(b){a.UnitBase.call(this),a.UnitInput.call(this),a.UnitOutput.call(this),a.extend(this.params,this.defaultParams),a.extend(this.params,b),this._nShaper=a.nWaveShaper(),this._nInput.connect(this._nShaper),this._nShaper.connect(this._nOutput),this._curve=new Float32Array(d),this._nShaper.curve=this._curve,this._nShaper.oversampleType="2x",this._curveFactor=.2,this.setParams(this.params)}var d=65536,e=d/2;c.prototype={defaultParams:{pQuality:1,pDrive:1},_Quality:function(){b(this._curve,this.params.pQuality)},_Drive:function(b,c,d){a.$(this._nInput.gain,this.params.pDrive,b,c,d)}},a.extend(c.prototype,a.UnitBase.prototype),a.extend(c.prototype,a.UnitInput.prototype),a.extend(c.prototype,a.UnitOutput.prototype),a.Saturator=function(a){return new c(a)}}(WX),function(a){function b(b){a.UnitBase.call(this),a.UnitInput.call(this),a.extend(this.params,this.defaultParams),a.extend(this.params,b),this._nAnalyzer=a.nAnalyzer(),this._nInput.connect(this._nAnalyzer),this._ctx2d=null,this._buffer=new Float32Array(this._nAnalyzer.frequencyBinCount),this._renderSetting={binCount:this._nAnalyzer.frequencyBinCount,binSize:a.sampleRate/this._nAnalyzer.frequencyBinCount,logMax:Math.log((this._nAnalyzer.frequencyBinCount-1)/1,2),baseX:0,unitX:0,scaleY:0},this.setParams(this.params)}var c=10,d=.5*a.sampleRate,e=2;b.prototype={defaultParams:{pLabel:"Spectrum",pSmoothingTimeConstant:.9,pMaxDecibels:0,pMinDecibels:-60,pScale:"log",pAutoClear:!0,pShowGrid:!1},_SmoothingTimeConstant:function(){this._nAnalyzer.smoothingTimeConstant=this.params.pSmoothingTimeConstant},_MaxDecibels:function(){this._nAnalyzer.maxDecibels=this.params.pMaxDecibels},_MinDecibels:function(){this._nAnalyzer.minDecibels=this.params.pMinDecibels},_updateSize:function(){this._renderSetting.baseX=this._ctx2d.canvas.width/4,this._renderSetting.unitX=this._ctx2d.canvas.width/this._buffer.length,this._renderSetting.scaleY=this._ctx2d.canvas.height},_drawGrid:function(a){var b=this._ctx2d;b.lineWidth=.5,b.strokeStyle=a||"#666",b.beginPath();for(var e=0;c>e;e++){var f=e*b.canvas.width/c,g=d*Math.pow(2,e-c);b.moveTo(f,0),b.lineTo(f,b.canvas.height),b.fillText(~~g+"Hz",f+5,b.canvas.height-10)}for(var h=this.params.pMinDecibels/6,i=0;h>i;i++){var j=i*b.canvas.height/h,k=0+-6*i;b.moveTo(0,j),b.lineTo(b.canvas.width,j),b.fillText(~~k+"dB",b.canvas.width-30,j+15)}b.stroke()},setContext2D:function(a){this._ctx2d=a,this._updateSize()},draw:function(a,b){var c=this._ctx2d,d=this.params,f=this._renderSetting;d.pAutoClear&&c.clearRect(0,0,c.canvas.width,c.canvas.height),d.pShowGrid&&this.drawGrid(b),c.lineWidth=.75,c.strokeStyle=a||"#222",c.beginPath(),this._nAnalyzer.getFloatFrequencyData(this._buffer);for(var g=1;g<f.binCount;g++)if("linear"===d.pScale)c.moveTo(g*f.unitX,f.scaleY),c.lineTo(g*f.unitX,this._buffer[g]*-.01*f.scaleY);else{var h=c.canvas.width*Math.log(g/1,e)/f.logMax;c.lineTo(h,this._buffer[g]*-.01*f.scaleY)}c.stroke()}},a.extend(b.prototype,a.UnitBase.prototype),a.extend(b.prototype,a.UnitInput.prototype),a.Spectrum=function(a){return new b(a)}}(WX),function(a){function b(b){a.UnitBase.call(this),a.UnitOutput.call(this),a.extend(this.params,this.defaultParams),a.extend(this.params,b),this._nStep=a.nSource(),this._nStep.connect(this._nOutput),this._nStep.buffer=c,this._nStep.loop=!0,this._nStep.loopEnd=1,this.setParams(this.params),this._nStep.start(a.now)}for(var c=a.nBuffer(1,a.context.sampleRate,a.context.sampleRate),d=new Float32Array(a.context.sampleRate),e=0;e<a.context.sampleRate;++e)d[e]=1;c.getChannelData(0).set(d,0),b.prototype={defaultParams:{pLabel:"Step",pGain:1},stop:function(b){this._nStep.stop(b||a.now)}},a.extend(b.prototype,a.UnitBase.prototype),a.extend(b.prototype,a.UnitOutput.prototype),a.Step=function(a){return new b(a)}}(WX),function(a){function b(b){a.UnitBase.call(this),a.UnitInput.call(this),a.extend(this.params,this.defaultParams),a.extend(this.params,b),this._nAnalyzer1=a.nAnalyzer(),this._nAnalyzer2=a.nAnalyzer();var c=a.nSplitter(2);this._nInput.connect(c),c.connect(this._nAnalyzer1,0,0),c.connect(this._nAnalyzer2,1,0),this._f32Buffer1=new Float32Array(this._nAnalyzer1.frequencyBinCount),this._f32Buffer2=new Float32Array(this._nAnalyzer2.frequencyBinCount),this._u8Buffer1=new Uint8Array(this._nAnalyzer1.frequencyBinCount),this._u8Buffer2=new Uint8Array(this._nAnalyzer2.frequencyBinCount),this.setParams(this.params)}b.prototype={defaultParams:{pLabel:"StereoVisualizer",pSmoothingTimeConstant:.9,pMaxDecibels:0,pMinDecibels:-60},_SmoothingTimeConstant:function(){this._nAnalyzer1.smoothingTimeConstant=this.params.pSmoothingTimeConstant,this._nAnalyzer2.smoothingTimeConstant=this.params.pSmoothingTimeConstant},_MaxDecibels:function(){this._nAnalyzer1.maxDecibels=this.params.pMaxDecibels,this._nAnalyzer2.maxDecibels=this.params.pMaxDecibels},_MinDecibels:function(){this._nAnalyzer1.minDecibels=this.params.pMinDecibels,this._nAnalyzer2.minDecibels=this.params.pMinDecibels},_ondraw:function(){},drawSpectrum:function(){this._nAnalyzer1.getFloatFrequencyData(this._f32Buffer1),this._nAnalyzer2.getFloatFrequencyData(this._f32Buffer2),this._ondraw(this._f32Buffer1,this._f32Buffer2)},drawWaveform:function(){this._nAnalyzer1.getByteTimeDomainData(this._u8Buffer1),this._nAnalyzer2.getByteTimeDomainData(this._u8Buffer2),this._ondraw(this._u8Buffer1,this._u8Buffer2)},onDraw:function(a){this._ondraw=a}},a.extend(b.prototype,a.UnitBase.prototype),a.extend(b.prototype,a.UnitInput.prototype),a.StereoVisualizer=function(a){return new b(a)}}(WX);